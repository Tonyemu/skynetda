---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2022/4/11 16:34
---


package.cpath=package.cpath..";../luasocket/core.so"
local socket = require("socket")


local host, port = "127.0.0.1", 9090

local server = assert(socket.bind(host, port))

local log = io.open("./fuck","a")
while true
do
    print("server: waiting for client connection ...")
    local control = assert(server:accept())
    while true
    do
        local data = control:receive()
        log:write(data)
        log:write("\r\n")
        log:flush()
        io.stdout:write(data)
        io.stdout:write("\r\n")

        io.stdout:flush()
        --control:send(ack)       -- 注意：发送的数据必须要有结束符才能发送成功
    end

end
